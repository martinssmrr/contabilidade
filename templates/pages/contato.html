{% extends 'base.html' %}
{% load static %}

{% block title %}Contato - Vetorial Contabilidade{% endblock %}
{% block description %}Entre em contato com a Vetorial Contabilidade. Estamos prontos para atender sua empresa por WhatsApp, telefone, e-mail ou formulário de contato.{% endblock %}
{% block canonical %}/contato/{% endblock %}

{% block extra_css %}
<style>
    .ct-hero {
        background: linear-gradient(135deg, #0c63d1 0%, #0a4fa3 100%);
        padding: 100px 0 60px; text-align: center;
    }
    .ct-hero h1 { color: #fff; font-size: 2.8rem; font-weight: 800; margin-bottom: 1rem; }
    .ct-hero p  { color: rgba(255,255,255,.85); font-size: 1.15rem; max-width: 600px; margin: 0 auto; }

    /* Canais */
    .ct-channels { padding: 80px 0; background: #ebeef1; }
    .channel-card {
        background: #fff; border-radius: 14px; padding: 36px 28px;
        text-align: center; height: 100%; transition: all .3s ease;
        border: 1px solid #e7e7e7; text-decoration: none; color: inherit;
        display: block;
    }
    .channel-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,.08); border-color: #0c63d1; color: inherit; }
    .channel-icon {
        width: 72px; height: 72px; border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        margin: 0 auto 18px;
    }
    .channel-icon.whatsapp { background: #25d366; }
    .channel-icon.phone    { background: #0c63d1; }
    .channel-icon.email    { background: #ea4335; }
    .channel-icon.map      { background: #fbbc04; }
    .channel-icon i { font-size: 1.6rem; color: #fff; }
    .channel-card h3 { font-size: 1.1rem; font-weight: 700; color: #1f2937; margin-bottom: .4rem; }
    .channel-card p  { color: #6b7280; font-size: .9rem; margin: 0; }

    /* Formulário */
    .ct-form-section { padding: 80px 0; background: #fff; }
    .ct-form-wrapper {
        background: #fff; border-radius: 16px; padding: 48px;
        box-shadow: 0 10px 40px rgba(0,0,0,.06); max-width: 800px; margin: 0 auto;
        border: 1px solid #e7e7e7;
    }
    .ct-form-wrapper h2 { font-weight: 700; margin-bottom: .5rem; }

    /* Mapa / Info */
    .ct-info { padding: 80px 0; background: #ebeef1; }
    .info-row {
        display: flex; align-items: flex-start; gap: 14px;
        margin-bottom: 20px;
    }
    .info-icon {
        min-width: 40px; height: 40px; border-radius: 10px;
        background: #0c63d1; display: flex; align-items: center; justify-content: center;
    }
    .info-icon i { color: #fff; font-size: .9rem; }
    .info-row h5 { font-size: .95rem; font-weight: 700; margin-bottom: 2px; }
    .info-row p { font-size: .9rem; color: #6b7280; margin: 0; }

    /* CTA */
    .ct-cta {
        background: linear-gradient(135deg, #0c63d1,#0a4fa3);
        padding: 80px 0; text-align: center;
    }
    .ct-cta h2 { color: #fff; font-size: 2.2rem; font-weight: 700; margin-bottom: 1rem; }
    .ct-cta p  { color: rgba(255,255,255,.85); max-width: 600px; margin: 0 auto 2rem; font-size: 1.1rem; }
    .btn-cta-green {
        background: #3ef47c; color: #1f2937; border: none;
        padding: 14px 40px; border-radius: 10px; font-weight: 700;
        font-size: 1.05rem; text-decoration: none; display: inline-block;
        transition: all .3s ease;
    }
    .btn-cta-green:hover { background: #2ed66b; transform: translateY(-2px); color: #1f2937; }

    @media (max-width: 768px) { .ct-hero h1 { font-size: 2rem; } .ct-form-wrapper { padding: 28px; } }
</style>
{% endblock %}

{% block content %}
<!-- Hero -->
<section class="ct-hero">
    <div class="container">
        <h1>Fale Conosco</h1>
        <p>Estamos prontos para ajudar sua empresa. Escolha o canal que preferir e entre em contato agora mesmo.</p>
    </div>
</section>

<!-- Canais de Contato -->
<section class="ct-channels">
    <div class="container">
        <div class="row g-4">
            <div class="col-lg-3 col-md-6">
                <a href="https://wa.me/551131642284" target="_blank" class="channel-card">
                    <div class="channel-icon whatsapp"><i class="fab fa-whatsapp"></i></div>
                    <h3>WhatsApp</h3>
                    <p>(11) 3164-2284<br><small>Resposta imediata</small></p>
                </a>
            </div>
            <div class="col-lg-3 col-md-6">
                <a href="tel:+551131642284" class="channel-card">
                    <div class="channel-icon phone"><i class="fas fa-phone-alt"></i></div>
                    <h3>Telefone</h3>
                    <p>(11) 3164-2284<br><small>Seg a Sex, 9h às 18h</small></p>
                </a>
            </div>
            <div class="col-lg-3 col-md-6">
                <a href="mailto:contato@vetorialcontabilidade.com.br" class="channel-card">
                    <div class="channel-icon email"><i class="fas fa-envelope"></i></div>
                    <h3>E-mail</h3>
                    <p>contato@vetorialcontabilidade.com.br<br><small>Resposta em até 24h</small></p>
                </a>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="channel-card">
                    <div class="channel-icon map"><i class="fas fa-map-marker-alt"></i></div>
                    <h3>Endereço</h3>
                    <p>Atendimento 100% Online<br><small>Presente em todo o Brasil</small></p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Formulário de Contato -->
<section class="ct-form-section" id="formulario">
    <div class="container">
        <div class="ct-form-wrapper">
            <div class="text-center mb-4">
                <h2>Envie sua mensagem</h2>
                <p class="text-muted">Preencha o formulário abaixo e nossa equipe entrará em contato o mais rápido possível.</p>
            </div>
            <form id="contactFormPage">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="ctNome" class="form-label fw-semibold">Nome Completo *</label>
                        <input type="text" class="form-control" id="ctNome" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="ctEmail" class="form-label fw-semibold">E-mail *</label>
                        <input type="email" class="form-control" id="ctEmail" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="ctTelefone" class="form-label fw-semibold">Telefone *</label>
                        <input type="tel" class="form-control" id="ctTelefone" placeholder="(00) 00000-0000" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="ctEstado" class="form-label fw-semibold">Estado *</label>
                        <select class="form-select" id="ctEstado" required>
                            <option value="">Selecione...</option>
                            <option value="AC">Acre</option><option value="AL">Alagoas</option>
                            <option value="AP">Amapá</option><option value="AM">Amazonas</option>
                            <option value="BA">Bahia</option><option value="CE">Ceará</option>
                            <option value="DF">Distrito Federal</option><option value="ES">Espírito Santo</option>
                            <option value="GO">Goiás</option><option value="MA">Maranhão</option>
                            <option value="MT">Mato Grosso</option><option value="MS">Mato Grosso do Sul</option>
                            <option value="MG">Minas Gerais</option><option value="PA">Pará</option>
                            <option value="PB">Paraíba</option><option value="PR">Paraná</option>
                            <option value="PE">Pernambuco</option><option value="PI">Piauí</option>
                            <option value="RJ">Rio de Janeiro</option><option value="RN">Rio Grande do Norte</option>
                            <option value="RS">Rio Grande do Sul</option><option value="RO">Rondônia</option>
                            <option value="RR">Roraima</option><option value="SC">Santa Catarina</option>
                            <option value="SP">São Paulo</option><option value="SE">Sergipe</option>
                            <option value="TO">Tocantins</option>
                        </select>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="ctServico" class="form-label fw-semibold">Assunto / Serviço de Interesse *</label>
                    <select class="form-select" id="ctServico" required>
                        <option value="">Selecione...</option>
                        <option value="abrir_empresa">Abrir Empresa</option>
                        <option value="trocar_contador">Trocar de Contador</option>
                        <option value="contabilidade_mei">Contabilidade para MEI</option>
                        <option value="gestao_contabil">Gestão Contábil Completa</option>
                        <option value="bpo_financeiro">BPO Financeiro</option>
                        <option value="regularizacao">Regularização Empresarial</option>
                        <option value="certificado_digital">Certificado Digital</option>
                        <option value="outro">Outro assunto</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label for="ctMensagem" class="form-label fw-semibold">Mensagem</label>
                    <textarea class="form-control" id="ctMensagem" rows="4" placeholder="Descreva como podemos ajudar..."></textarea>
                </div>
                <div class="d-grid gap-2 d-sm-flex">
                    <button type="button" class="btn btn-success btn-lg flex-grow-1" onclick="enviarContatoWhatsApp()">
                        <i class="fab fa-whatsapp me-2"></i>Enviar por WhatsApp
                    </button>
                    <button type="button" class="btn btn-primary btn-lg flex-grow-1" onclick="enviarContatoLigacao()">
                        <i class="fas fa-phone me-2"></i>Solicitar Ligação
                    </button>
                </div>
            </form>
        </div>
    </div>
</section>

<!-- Informações complementares -->
<section class="ct-info">
    <div class="container">
        <div class="row g-5">
            <div class="col-lg-6">
                <h3 class="fw-bold mb-4">Informações da Empresa</h3>
                <div class="info-row">
                    <div class="info-icon"><i class="fas fa-building"></i></div>
                    <div>
                        <h5>Vetorial Contabilidade</h5>
                        <p>CNPJ: 57.397.355/0001-83 | CRC: 009504/O-3</p>
                    </div>
                </div>
                <div class="info-row">
                    <div class="info-icon"><i class="fas fa-clock"></i></div>
                    <div>
                        <h5>Horário de Atendimento</h5>
                        <p>Segunda a Sexta, das 9h às 18h</p>
                    </div>
                </div>
                <div class="info-row">
                    <div class="info-icon"><i class="fas fa-globe"></i></div>
                    <div>
                        <h5>Atendimento Nacional</h5>
                        <p>100% online, atendemos empresas em mais de 5.000 cidades brasileiras.</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <h3 class="fw-bold mb-4">Perguntas Rápidas</h3>
                <div class="mb-3 p-3 bg-white rounded-3">
                    <h6 class="fw-bold mb-1">Quanto tempo para receber retorno?</h6>
                    <p class="text-muted small mb-0">No WhatsApp, respondemos em minutos. Por e-mail, em até 24 horas úteis.</p>
                </div>
                <div class="mb-3 p-3 bg-white rounded-3">
                    <h6 class="fw-bold mb-1">Vocês atendem minha cidade?</h6>
                    <p class="text-muted small mb-0">Sim! Atendemos 100% online em todo o território nacional.</p>
                </div>
                <div class="mb-3 p-3 bg-white rounded-3">
                    <h6 class="fw-bold mb-1">A consulta inicial é gratuita?</h6>
                    <p class="text-muted small mb-0">Sim! Oferecemos diagnóstico gratuito para novos clientes.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA -->
<section class="ct-cta">
    <div class="container">
        <h2>Prefere falar agora mesmo?</h2>
        <p>Nosso time de especialistas está online para tirar suas dúvidas e apresentar a melhor solução para sua empresa.</p>
        <a href="https://wa.me/551131642284?text=Olá! Gostaria de falar com um especialista da Vetorial." class="btn-cta-green"><i class="fab fa-whatsapp me-2"></i>Chamar no WhatsApp</a>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

function getFormData() {
    const nome = document.getElementById('ctNome').value.trim();
    const email = document.getElementById('ctEmail').value.trim();
    const telefone = document.getElementById('ctTelefone').value.trim();
    const estado = document.getElementById('ctEstado').value;
    const servicoSelect = document.getElementById('ctServico');
    const servico = servicoSelect.value;
    const servicoText = servicoSelect.options[servicoSelect.selectedIndex].text;
    const mensagem = document.getElementById('ctMensagem').value.trim();

    if (!nome || !email || !telefone || !estado || !servico) {
        alert('Por favor, preencha todos os campos obrigatórios.');
        return null;
    }
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) { alert('Por favor, insira um e-mail válido.'); return null; }

    return { nome, email, telefone, estado, servico, servicoText, mensagem };
}

async function capturarLead(data, origem) {
    try {
        await fetch('/support/capturar-lead/', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-CSRFToken': getCookie('csrftoken') },
            body: JSON.stringify({
                nome_completo: data.nome, email: data.email, telefone: data.telefone,
                estado: data.estado, servico_interesse: data.servico, origem: origem
            })
        });
    } catch (e) { console.error('Erro ao capturar lead:', e); }
}

function enviarContatoWhatsApp() {
    const data = getFormData();
    if (!data) return;
    capturarLead(data, 'pagina_contato_whatsapp');
    const msg = `Olá! Gostaria de informações.\n\nNome: ${data.nome}\nEmail: ${data.email}\nTelefone: ${data.telefone}\nEstado: ${data.estado}\nServiço: ${data.servicoText}\n${data.mensagem ? 'Mensagem: ' + data.mensagem : ''}`;
    window.open(`https://wa.me/551131642284?text=${encodeURIComponent(msg)}`, '_blank');
}

async function enviarContatoLigacao() {
    const data = getFormData();
    if (!data) return;
    await capturarLead(data, 'pagina_contato_ligacao');
    alert(`Obrigado, ${data.nome}!\n\nEntraremos em contato no número ${data.telefone} para falar sobre: ${data.servicoText}\n\nAguarde nosso retorno em breve!`);
}

// Máscara telefone
document.addEventListener('DOMContentLoaded', function() {
    const tel = document.getElementById('ctTelefone');
    if (tel) {
        tel.addEventListener('input', function(e) {
            let v = e.target.value.replace(/\D/g, '');
            if (v.length <= 11) {
                v = v.replace(/^(\d{2})(\d)/g, '($1) $2');
                v = v.replace(/(\d)(\d{4})$/, '$1-$2');
            }
            e.target.value = v;
        });
    }
});
</script>
{% endblock %}
